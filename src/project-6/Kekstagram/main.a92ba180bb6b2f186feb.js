!function(e){function t(t){for(var r,a,i=t[0],u=t[1],s=t[2],d=0,f=[];d<i.length;d++)a=i[d],Object.prototype.hasOwnProperty.call(o,a)&&o[a]&&f.push(o[a][0]),o[a]=0;for(r in u)Object.prototype.hasOwnProperty.call(u,r)&&(e[r]=u[r]);for(l&&l(t);f.length;)f.shift()();return c.push.apply(c,s||[]),n()}function n(){for(var e,t=0;t<c.length;t++){for(var n=c[t],r=!0,i=1;i<n.length;i++){var u=n[i];0!==o[u]&&(r=!1)}r&&(c.splice(t--,1),e=a(a.s=n[0]))}return e}var r={},o={0:0},c=[];function a(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=r,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)a.d(n,r,function(t){return e[t]}.bind(null,r));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="";var i=window.webpackJsonp=window.webpackJsonp||[],u=i.push.bind(i);i.push=t,i=i.slice();for(var s=0;s<i.length;s++)t(i[s]);var l=u;c.push([121,1]),n()}({121:function(e,t,n){n(122),e.exports=n(308)},308:function(e,t,n){"use strict";n.r(t);var r=function(e){for(var t=document.querySelector(".big-picture"),n=document.getElementById("comment").content,r=t.querySelector(".social__comments"),o=document.querySelectorAll(".picture__link"),c=document.getElementById("picture-cancel"),a=function(a){o[a].addEventListener("click",(function(){document.body.classList.add("modal-open"),t.classList.remove("hidden"),r.innerHTML="",document.querySelector(".social__comment-count").innerHTML=e[a].comments.length>=5?'5 из <span class="comments-count">'.concat(e[a].comments.length,"</span> комментариев"):"".concat(e[a].comments.length,' из <span class="comments-count">').concat(e[a].comments.length,"</span> комментариев"),t.querySelector("img").src=e[a].url,t.querySelector(".likes-count").textContent=e[a].likes,t.querySelector(".comments-count").textContent=e[a].comments.length,t.querySelector(".social__caption").textContent=e[a].description,e[a].comments.forEach((function(e){var t=n.cloneNode(!0);t.querySelector(".social__picture").src="".concat(e.avatar),t.querySelector(".social__text").textContent=e.message,r.appendChild(t)}));var o=document.querySelector(".social__loadmore"),i=document.querySelectorAll(".social__comment"),u=5;if(i.length>5){o.classList.remove("hidden");for(var s=5;s<i.length;s++)i[s].classList.add("visually-hidden")}function l(){for(var t=u;t<u+5;t++){if(!i[t]){o.classList.add("hidden");break}i[t].classList.remove("visually-hidden")}u+5<i.length?u+=5:u=i.length;var n="".concat(u,' из <span class="comments-count">').concat(e[a].comments.length,"</span> комментариев");document.querySelector(".social__comment-count").innerHTML=n}function d(){t.classList.add("hidden"),document.body.classList.remove("modal-open"),o.removeEventListener("click",l)}o.addEventListener("click",l),c.addEventListener("click",(function(){return d()})),t.addEventListener("click",(function(e){e.target===t&&d()})),document.addEventListener("keydown",(function(e){27===e.keyCode&&d()}))}))},i=0;i<e.length;i++)a(i)};function o(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function a(e,t,n,r,o,c,a){try{var i=e[c](a),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var c=e.apply(t,n);function i(e){a(c,r,o,i,u,"next",e)}function u(e){a(c,r,o,i,u,"throw",e)}i(void 0)}))}}function u(){return s.apply(this,arguments)}function s(){return(s=i(regeneratorRuntime.mark((function e(){var t,n,c,a,i,u,s,l,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"https://javascript.pages.academy/kekstagram/data",t=document.getElementById("picture").content,n=document.querySelector(".pictures"),c=document.querySelector(".img-filters"),a=document.querySelectorAll(".img-filters__button"),e.prev=5,l=function(){var e=null;return function(t){e&&clearTimeout(e),e=setTimeout((function(){s(t),r(t)}),500)}},s=function(e){document.querySelectorAll(".picture__link").forEach((function(e){return e.remove()})),e.forEach((function(e){var r=t.cloneNode(!0);r.querySelector(".picture__img").src=e.url,r.querySelector(".picture__stat--comments").textContent=e.comments.length,r.querySelector(".picture__stat--likes").textContent=e.likes,n.appendChild(r)}))},e.next=10,fetch("https://javascript.pages.academy/kekstagram/data");case 10:return i=e.sent,e.next=13,i.json();case 13:u=e.sent,s(u),r(u),c.classList.remove("img-filters--inactive"),d=l(),a.forEach((function(e){e.addEventListener("click",(function(){for(var t=0;t<a.length;t++)a[t].classList.remove("img-filters__button--active");e.classList.add("img-filters__button--active");var n=[];if("filter-popular"===e.id&&(n=[],n=o(u),d(n)),"filter-new"===e.id){n=[];for(var r=null,c=0;c<10;c++){do{r=Math.floor(Math.random()*u.length)}while(n.includes(u[r]));n.push(u[r])}d(n)}"filter-discussed"===e.id&&(n=[],n=u.slice().sort((function(e,t){return t.comments.length-e.comments.length})),d(n))}))})),e.next=24;break;case 21:e.prev=21,e.t0=e.catch(5),console.log(e.t0);case 24:case"end":return e.stop()}}),e,null,[[5,21]])})))).apply(this,arguments)}u();function l(){var e=document.getElementById("upload-file");e.addEventListener("change",(function(){var t=document.querySelector(".img-upload__overlay"),n=document.getElementById("user-picture"),r=e.files[0];if(r){var o=new FileReader;o.addEventListener("load",(function(){return n.src=o.result})),o.readAsDataURL(r)}function c(e){var t=document.querySelector(".text__hashtags"),n=document.querySelector(".text__description");27===e.keyCode&&document.activeElement!==t&&document.activeElement!==n&&a()}function a(){e.value="",t.classList.add("hidden"),document.removeEventListener("keydown",c)}t.classList.remove("hidden"),document.getElementById("upload-cancel").addEventListener("click",(function(){a()})),document.addEventListener("keydown",c)}))}l();function d(){var e=document.querySelector(".resize__control--plus"),t=document.querySelector(".resize__control--minus"),n=document.querySelector(".resize__control--value"),r=document.querySelector(".img-upload__preview"),o=n.value;e.addEventListener("click",(function(){parseInt(o)<100&&(o="".concat(parseInt(o)+25,"%"),n.value=o,r.style.transform="scale(".concat(parseInt(o)/100,")"))})),t.addEventListener("click",(function(){parseInt(o)>25&&(o="".concat(parseInt(o)-25,"%"),document.querySelector(".resize__control--value").value=o,r.style.transform="scale(".concat(parseInt(o)/100,")"))}))}d();function f(){var e=document.getElementById("user-picture"),t=document.querySelectorAll(".effects__radio"),n=document.querySelector(".img-upload__scale"),r=n.querySelector(".scale__value"),o=(n.querySelector(".scale__line"),n.querySelector(".scale__pin")),c=n.querySelector(".scale__level");function a(){for(var n=r.value,o=0;o<t.length;o++)if(t[o].checked)switch(t[o].value){case"none":e.style.filter=null;break;case"chrome":e.style.filter="grayscale(".concat(n/100,")");break;case"sepia":e.style.filter="sepia(".concat(n/100,")");break;case"marvin":e.style.filter="invert(".concat(n,"%)");break;case"phobos":e.style.filter="blur(".concat(n/100*3,"px)");break;case"heat":e.style.filter="brightness(".concat(1+n/100*2,")")}}t.forEach((function(i){i.addEventListener("click",(function(){r.value=100,a();for(var u=null,s=0;s<t.length;s++)u=t[s].value,t[s].checked?e.classList.add("effects__preview--".concat(u)):e.classList.remove("effects__preview--".concat(u));"none"===i.value?n.classList.add("hidden"):(n.classList.remove("hidden"),o.style.left="".concat(c.offsetWidth,"px"))}))})),o.addEventListener("mousedown",(function(e){var t=c.getBoundingClientRect(),n={};n.top=t.top+pageYOffset,n.left=t.left+pageXOffset;var i=o.getBoundingClientRect(),u={};u.top=i.top+pageYOffset,u.left=i.left+pageXOffset;var s=null,l=c.offsetWidth;function d(e){(s=e.pageX-n.left)<0&&(s=0),s>l&&(s=l),o.style.left="".concat(s,"px"),r.value=Math.floor(s/c.offsetWidth*100),a(),document.addEventListener("mouseup",f)}function f(){document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",f),a()}document.addEventListener("mousemove",d)}))}f();function m(e,t,n,r,o,c,a){try{var i=e[c](a),u=i.value}catch(e){return void n(e)}i.done?t(u):Promise.resolve(u).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var c=e.apply(t,n);function a(e){m(c,r,o,a,i,"next",e)}function i(e){m(c,r,o,a,i,"throw",e)}a(void 0)}))}}var v=function(){var e=document.getElementById("upload-select-image"),t="https://javascript.pages.academy/kekstagram";function n(){return(n=p(regeneratorRuntime.mark((function n(r){var o;return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r.preventDefault(),n.prev=1,n.next=4,fetch(t,{method:"POST",mode:"no-cors",body:new FormData(e)});case 4:return o=n.sent,n.next=7,o.text();case 7:n.sent,n.next=13;break;case 10:n.prev=10,n.t0=n.catch(1),alert(n.t0.message);case 13:case"end":return n.stop()}}),n,null,[[1,10]])})))).apply(this,arguments)}e.addEventListener("submit",(function(e){return n.apply(this,arguments)}))};function y(){var e=document.querySelector(".text__hashtags"),t=document.querySelector(".text__description");e.addEventListener("input",(function(){var t=function(e){for(var t=0;t<e.length;t++){if("#"!==e[t][0])return"Хэштэг должен начинаться с #";if("#"===e[t])return"Хэштэг не может состоять только из символа #";if(e[t].length>20)return"Максимальная длина хэштэга 20 символов";if(e.indexOf(e[t])!==t)return"Один хэштэг нельзя использовать дважды";if(e.length>5)return"Максимум можно поставить 5 хэштэгов"}return""}(e.value.trim().split(" ").filter((function(e){return""!==e})).map((function(e){return e.toLowerCase()})));e.setCustomValidity(t),""!==t?e.classList.add("text__hashtags--error"):e.classList.remove("text__hashtags--error")})),t.addEventListener("input",(function(){"".length>140&&(t.classList.add("text__description--error"),t.setCustomValidity("Длина комментария не должна превышать 140 символов"));t.setCustomValidity("")})),v()}y()}});